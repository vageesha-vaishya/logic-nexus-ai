import{j as e}from"./jsx-runtime-DF2Pcvd1.js";import{r as o}from"./index-B2-qRKKC.js";import{C as c,a as d,b as m,c as u,d as h}from"./card-DDgMyP-I.js";import{S as K,a as I,b as L,c as V,d as j}from"./select-CbrB-pmO.js";import{T as P,a as G,b as S}from"./tabs-BcAn1uNm.js";import{B as M}from"./badge-BlxpgidI.js";import{S as X}from"./scroll-area-BZ8Y1bzI.js";import{S as Y}from"./skeleton-table-CJFt9Koo.js";import{E as N,e as _}from"./empty-state-bzU-iTlr.js";import{c as p}from"./utils-CytzSlOG.js";import{R as q,P as F,a as H,C as $,T as f,L as w,B as T,b as z,X as E,Y as D,c as b}from"./PieChart-Z7NiK8FN.js";const g=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16","#fb7185"];function J({segments:t,defaultCriteria:B="demographic",loading:O,error:y,className:l}){const[n,R]=o.useState(B),[x,A]=o.useState("distribution"),v=o.useMemo(()=>t.map((a,r)=>({name:a.name,value:a.size,fill:a.color||g[r%g.length]})),[t]),k=o.useMemo(()=>{if(n==="demographic"){const r={};return t.forEach(s=>{var C;const i=((C=s.demographic)==null?void 0:C.industry)||"Other";r[i]=(r[i]||0)+s.size}),Object.entries(r).map(([s,i])=>({label:s,total:i}))}if(n==="behavioral")return t.map(r=>{var s,i;return{label:r.name,email_opens:((s=r.behavioral)==null?void 0:s.email_opens)||0,site_visits:((i=r.behavioral)==null?void 0:i.site_visits)||0}});const a={};return t.forEach(r=>{var i;const s=((i=r.geographic)==null?void 0:i.region)||"Other";a[s]=(a[s]||0)+r.size}),Object.entries(a).map(([r,s])=>({label:r,total:s}))},[t,n]);return O?e.jsxs(c,{className:p(l),children:[e.jsxs(d,{children:[e.jsx(m,{children:"Customer Segmentation"}),e.jsx(u,{children:"Loading segments"})]}),e.jsx(h,{children:e.jsx(Y,{count:4})})]}):y?e.jsxs(c,{className:p(l),children:[e.jsxs(d,{children:[e.jsx(m,{children:"Customer Segmentation"}),e.jsx(u,{children:"Error state"})]}),e.jsx(h,{children:e.jsx(N,{..._.error(y)})})]}):!t||t.length===0?e.jsxs(c,{className:p(l),children:[e.jsxs(d,{children:[e.jsx(m,{children:"Customer Segmentation"}),e.jsx(u,{children:"Empty state"})]}),e.jsx(h,{children:e.jsx(N,{..._.noItems("Segment")})})]}):e.jsxs(c,{className:p("h-full flex flex-col",l),children:[e.jsxs(d,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-lg",children:"Customer Segmentation"}),e.jsx(u,{children:"Distribution and criteria-based breakdown"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(K,{value:n,onValueChange:a=>R(a),children:[e.jsx(I,{className:"w-[180px] h-9",children:e.jsx(L,{placeholder:"Criteria"})}),e.jsxs(V,{children:[e.jsx(j,{value:"demographic",children:"Demographic"}),e.jsx(j,{value:"behavioral",children:"Behavioral"}),e.jsx(j,{value:"geographic",children:"Geographic"})]})]})})]}),e.jsx(P,{value:x,onValueChange:a=>A(a),className:"w-full",children:e.jsxs(G,{className:"grid w-full grid-cols-2",children:[e.jsx(S,{value:"distribution",children:"Distribution"}),e.jsx(S,{value:"breakdown",children:"Breakdown"})]})})]}),e.jsxs(h,{className:"flex-1 min-h-0",children:[x==="distribution"&&e.jsxs("div",{className:"grid gap-4 lg:grid-cols-7",children:[e.jsx("div",{className:"col-span-4 h-[320px]",children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(F,{children:[e.jsx(H,{data:v,cx:"50%",cy:"50%",innerRadius:60,outerRadius:90,paddingAngle:5,dataKey:"value",children:v.map((a,r)=>e.jsx($,{fill:a.fill},`cell-${r}`))}),e.jsx(f,{}),e.jsx(w,{verticalAlign:"bottom",height:36})]})})}),e.jsx("div",{className:"col-span-3",children:e.jsx(X,{className:"h-[320px] pr-3",children:e.jsx("div",{className:"space-y-2",children:t.map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-sm",style:{backgroundColor:a.color||g[r%g.length]}}),e.jsx("span",{className:"text-sm font-medium",children:a.name})]}),e.jsx(M,{variant:"secondary",className:"font-mono",children:Intl.NumberFormat(void 0).format(a.size)})]},a.id))})})})]}),x==="breakdown"&&e.jsx("div",{className:"h-[340px]",children:e.jsx(q,{width:"100%",height:"100%",children:n==="behavioral"?e.jsxs(T,{data:k,margin:{top:10,right:20,left:10,bottom:0},children:[e.jsx(z,{strokeDasharray:"3 3",vertical:!1}),e.jsx(E,{dataKey:"label",tick:{fontSize:12}}),e.jsx(D,{}),e.jsx(f,{}),e.jsx(w,{}),e.jsx(b,{dataKey:"email_opens",fill:"#06b6d4",name:"Email Opens"}),e.jsx(b,{dataKey:"site_visits",fill:"#8b5cf6",name:"Site Visits"})]}):e.jsxs(T,{data:k,margin:{top:10,right:20,left:10,bottom:0},children:[e.jsx(z,{strokeDasharray:"3 3",vertical:!1}),e.jsx(E,{dataKey:"label",tick:{fontSize:12}}),e.jsx(D,{}),e.jsx(f,{}),e.jsx(b,{dataKey:"total",fill:"#3b82f6",name:"Total",radius:[4,4,0,0]})]})})})]})]})}J.__docgenInfo={description:"",methods:[],displayName:"CustomerSegmentation",props:{segments:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  id: string;
  name: string;
  size: number;
  color?: string;
  demographic?: { industry?: string; title?: string; company_size?: string };
  behavioral?: { last_activity_days?: number; email_opens?: number; site_visits?: number };
  geographic?: { region?: string; country?: string };
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"size",value:{name:"number",required:!0}},{key:"color",value:{name:"string",required:!1}},{key:"demographic",value:{name:"signature",type:"object",raw:"{ industry?: string; title?: string; company_size?: string }",signature:{properties:[{key:"industry",value:{name:"string",required:!1}},{key:"title",value:{name:"string",required:!1}},{key:"company_size",value:{name:"string",required:!1}}]},required:!1}},{key:"behavioral",value:{name:"signature",type:"object",raw:"{ last_activity_days?: number; email_opens?: number; site_visits?: number }",signature:{properties:[{key:"last_activity_days",value:{name:"number",required:!1}},{key:"email_opens",value:{name:"number",required:!1}},{key:"site_visits",value:{name:"number",required:!1}}]},required:!1}},{key:"geographic",value:{name:"signature",type:"object",raw:"{ region?: string; country?: string }",signature:{properties:[{key:"region",value:{name:"string",required:!1}},{key:"country",value:{name:"string",required:!1}}]},required:!1}}]}}],raw:"Segment[]"},description:""},defaultCriteria:{required:!1,tsType:{name:"union",raw:"'demographic' | 'behavioral' | 'geographic'",elements:[{name:"literal",value:"'demographic'"},{name:"literal",value:"'behavioral'"},{name:"literal",value:"'geographic'"}]},description:"",defaultValue:{value:"'demographic'",computed:!1}},loading:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{J as C};
